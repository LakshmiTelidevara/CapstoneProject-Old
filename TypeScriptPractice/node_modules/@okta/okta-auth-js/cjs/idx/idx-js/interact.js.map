{"version":3,"sources":["../../../../lib/idx/idx-js/interact.ts"],"names":["parseAndReject","response","json","then","err","reject","interact","withCredentials","clientId","baseUrl","scopes","redirectUri","codeChallenge","codeChallengeMethod","state","activationToken","recoveryToken","clientSecret","target","params","client_id","scope","join","redirect_uri","code_challenge","code_challenge_method","activation_token","recovery_token","client_secret","body","param","value","encodeURIComponent","headers","credentials","ok","data","interaction_handle"],"mappings":";;;;;;;;;;;;AAcA;;AAdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAGA,MAAMA,cAAc,GAAGC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,GAAgBC,IAAhB,CAAsBC,GAAG,IAAI,iBAAQC,MAAR,CAAeD,GAAf,CAA7B,CAAnC;;AAEA,MAAME,QAAQ,GAAG,eAAeA,QAAf,CAAwB;AACvCC,EAAAA,eADuC;AAEvCC,EAAAA,QAFuC;AAGvCC,EAAAA,OAHuC;AAIvCC,EAAAA,MAAM,GAAG,CAAC,QAAD,EAAW,OAAX,CAJ8B;AAKvCC,EAAAA,WALuC;AAMvCC,EAAAA,aANuC;AAOvCC,EAAAA,mBAPuC;AAQvCC,EAAAA,KARuC;AASvCC,EAAAA,eATuC;AAUvCC,EAAAA,aAVuC;AAWvCC,EAAAA;AAXuC,CAAxB,EAYd;AAAA;;AAED,QAAMC,MAAM,GAAI,GAAET,OAAQ,cAA1B;AACA,QAAMU,MAAM,GAAG;AACbC,IAAAA,SAAS,EAAEZ,QADE;AAEba,IAAAA,KAAK,EAAEX,MAAM,CAACY,IAAP,CAAY,GAAZ,CAFM;AAGbC,IAAAA,YAAY,EAAEZ,WAHD;AAIba,IAAAA,cAAc,EAAEZ,aAJH;AAKba,IAAAA,qBAAqB,EAAEZ,mBALV;AAMbC,IAAAA;AANa,GAAf;;AAQA,MAAIC,eAAJ,EAAqB;AACnBI,IAAAA,MAAM,CAACO,gBAAP,GAA0BX,eAA1B;AACD;;AACD,MAAIC,aAAJ,EAAmB;AACjBG,IAAAA,MAAM,CAACQ,cAAP,GAAwBX,aAAxB;AACD;;AACD,MAAIC,YAAJ,EAAkB;AAChBE,IAAAA,MAAM,CAACS,aAAP,GAAuBX,YAAvB;AACD;;AACD,QAAMY,IAAI,GAAG,mDAAeV,MAAf,kBACL,CAAC,CAACW,KAAD,EAAQC,KAAR,CAAD,KAAqB,GAAED,KAAM,IAAGE,kBAAkB,CAACD,KAAD,CAAQ,EADrD,EAEVT,IAFU,CAEL,GAFK,CAAb;AAGA,QAAMW,OAAO,GAAG;AACd,oBAAgB;AADF,GAAhB;AAGA,QAAMC,WAAW,GAAG3B,eAAe,KAAK,KAApB,GAA4B,MAA5B,GAAqC,SAAzD;AACA,SAAO,qBAAQW,MAAR,EAAgB;AAAEgB,IAAAA,WAAF;AAAeD,IAAAA,OAAf;AAAwBJ,IAAAA;AAAxB,GAAhB,EACJ1B,IADI,CACEF,QAAQ,IAAIA,QAAQ,CAACkC,EAAT,GAAclC,QAAQ,CAACC,IAAT,EAAd,GAAgCF,cAAc,CAAEC,QAAF,CAD5D,EAEJE,IAFI,CAEEiC,IAAI,IAAIA,IAAI,CAACC,kBAFf,CAAP;AAGD,CA1CD;;eA4Ce/B,Q","sourcesContent":["/*!\n * Copyright (c) 2021-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint-disable camelcase */\n// @ts-nocheck\nimport { request } from './client';\n\nconst parseAndReject = response => response.json().then( err => Promise.reject(err) );\n\nconst interact = async function interact({\n  withCredentials,\n  clientId,\n  baseUrl,\n  scopes = ['openid', 'email'],\n  redirectUri,\n  codeChallenge,\n  codeChallengeMethod,\n  state,\n  activationToken,\n  recoveryToken,\n  clientSecret,\n}) {\n\n  const target = `${baseUrl}/v1/interact`;\n  const params = {\n    client_id: clientId,\n    scope: scopes.join(' '),\n    redirect_uri: redirectUri,\n    code_challenge: codeChallenge,\n    code_challenge_method: codeChallengeMethod,\n    state,\n  };\n  if (activationToken) {\n    params.activation_token = activationToken;\n  }\n  if (recoveryToken) {\n    params.recovery_token = recoveryToken;\n  }\n  if (clientSecret) {\n    params.client_secret = clientSecret;\n  }\n  const body = Object.entries(params)\n    .map( ([param, value]) => `${param}=${encodeURIComponent(value)}` )\n    .join('&');\n  const headers = {\n    'content-type': 'application/x-www-form-urlencoded',\n  };\n  const credentials = withCredentials === false ? 'omit' : 'include';\n  return request(target, { credentials, headers, body })\n    .then( response => response.ok ? response.json() : parseAndReject( response ) )\n    .then( data => data.interaction_handle);\n};\n\nexport default interact;\n"],"file":"interact.js"}